{"version":3,"file":"html-webpack-change-assets-extension-plugin.umd.js","sources":["../src/html-webpack-change-assets-extension-plugin.ts"],"sourcesContent":["const HtmlWebpackPlugin = require('html-webpack-plugin')\n\nexport default class HtmlWebpackChangeAssetsExtensionPlugin {\n  options: object\n\n  constructor(options?: object) {\n    this.options = options || {}\n  }\n\n  apply(compiler: any) {\n    compiler.hooks.compilation.tap('HtmlWebpackChangeAssetsExtensionPlugin', (compilation: any) => {\n      let beforeGenerationHook\n      if (compilation.hooks.htmlWebpackPluginBeforeHtmlGeneration) {\n        // HtmlWebpackPlugin 3\n        const { hooks } = compilation\n        beforeGenerationHook = hooks.htmlWebpackPluginBeforeHtmlGeneration\n      } else if (HtmlWebpackPlugin.version === 4) {\n        // HtmlWebpackPlugin >= 4\n        const hooks = HtmlWebpackPlugin.getHooks(compilation)\n        beforeGenerationHook = hooks.beforeAssetTagGeneration\n      }\n\n      beforeGenerationHook.tapAsync(\n        'HtmlWebpackChangeAssetsExtensionPlugin',\n        (data: any, cb: Function) => {\n          // Skip if the plugin configuration didn't set `jsExtension`\n          if (!data.plugin.options.jsExtension) {\n            return cb(null, data)\n          }\n          const jsExtension = data.plugin.options.jsExtension\n          const tempArray = data.assets.js\n          data.assets.js = tempArray.map((scriptFile: any) => {\n            if(data.plugin.options.extdebug) {\n              console.log('ext',scriptFile)\n            }\n            const s = scriptFile as string;\n            if(s) {\n              if (data.plugin.options.extlocalonly) {\n                if(data.plugin.options.extdebug) console.log('extlocalonly',s);\n                if (s.includes('http')) {\n                  if(data.plugin.options.extdebug) console.log('extlocalonly return',s);\n                  return scriptFile;\n                }\n              }\n              let ret = `${scriptFile}${jsExtension}`;\n              if(s.includes('?')) {\n                const fileSplit = s.split('?');\n                ret = `${fileSplit[0]}${jsExtension}?${fileSplit[1]}`;\n              }\n              return ret;\n            }\n\n            return `${scriptFile}${jsExtension}`\n          })\n          return cb(null, data)\n        }\n      )\n    })\n  }\n}\n"],"names":[],"mappings":";;;;;;EAAA,IAAM,iBAAiB,GAAG,OAAO,CAAC,qBAAqB,CAAC,CAAA;EAExD;MAGE,gDAAY,OAAgB;UAC1B,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,EAAE,CAAA;OAC7B;MAED,sDAAK,GAAL,UAAM,QAAa;UACjB,QAAQ,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,wCAAwC,EAAE,UAAC,WAAgB;cACxF,IAAI,oBAAoB,CAAA;cACxB,IAAI,WAAW,CAAC,KAAK,CAAC,qCAAqC,EAAE;;kBAEnD,IAAA,KAAK,GAAK,WAAW,MAAhB,CAAgB;kBAC7B,oBAAoB,GAAG,KAAK,CAAC,qCAAqC,CAAA;eACnE;mBAAM,IAAI,iBAAiB,CAAC,OAAO,KAAK,CAAC,EAAE;;kBAE1C,IAAM,KAAK,GAAG,iBAAiB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAA;kBACrD,oBAAoB,GAAG,KAAK,CAAC,wBAAwB,CAAA;eACtD;cAED,oBAAoB,CAAC,QAAQ,CAC3B,wCAAwC,EACxC,UAAC,IAAS,EAAE,EAAY;;kBAEtB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,EAAE;sBACpC,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;mBACtB;kBACD,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,CAAA;kBACnD,IAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAA;kBAChC,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,SAAS,CAAC,GAAG,CAAC,UAAC,UAAe;sBAC7C,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE;0BAC/B,OAAO,CAAC,GAAG,CAAC,KAAK,EAAC,UAAU,CAAC,CAAA;uBAC9B;sBACD,IAAM,CAAC,GAAG,UAAoB,CAAC;sBAC/B,IAAG,CAAC,EAAE;0BACJ,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,YAAY,EAAE;8BACpC,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;kCAAE,OAAO,CAAC,GAAG,CAAC,cAAc,EAAC,CAAC,CAAC,CAAC;8BAC/D,IAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;kCACtB,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;sCAAE,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAC,CAAC,CAAC,CAAC;kCACtE,OAAO,UAAU,CAAC;+BACnB;2BACF;0BACD,IAAI,GAAG,GAAG,KAAG,UAAU,GAAG,WAAa,CAAC;0BACxC,IAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;8BAClB,IAAM,SAAS,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;8BAC/B,GAAG,GAAG,KAAG,SAAS,CAAC,CAAC,CAAC,GAAG,WAAW,SAAI,SAAS,CAAC,CAAC,CAAG,CAAC;2BACvD;0BACD,OAAO,GAAG,CAAC;uBACZ;sBAED,OAAO,KAAG,UAAU,GAAG,WAAa,CAAA;mBACrC,CAAC,CAAA;kBACF,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;eACtB,CACF,CAAA;WACF,CAAC,CAAA;OACH;MACH,6CAAC;EAAD,CAAC;;;;;;;;"}