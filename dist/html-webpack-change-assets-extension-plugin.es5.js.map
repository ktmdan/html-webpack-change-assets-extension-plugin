{"version":3,"file":"html-webpack-change-assets-extension-plugin.es5.js","sources":["../src/html-webpack-change-assets-extension-plugin.ts"],"sourcesContent":["const HtmlWebpackPlugin = require('html-webpack-plugin')\n\nexport default class HtmlWebpackChangeAssetsExtensionPlugin {\n  options: object\n\n  constructor(options?: object) {\n    this.options = options || {}\n  }\n\n  apply(compiler: any) {\n    compiler.hooks.compilation.tap('HtmlWebpackChangeAssetsExtensionPlugin', (compilation: any) => {\n      let beforeGenerationHook\n      if (compilation.hooks.htmlWebpackPluginBeforeHtmlGeneration) {\n        // HtmlWebpackPlugin 3\n        const { hooks } = compilation\n        beforeGenerationHook = hooks.htmlWebpackPluginBeforeHtmlGeneration\n      } else if (HtmlWebpackPlugin.version === 4) {\n        // HtmlWebpackPlugin >= 4\n        const hooks = HtmlWebpackPlugin.getHooks(compilation)\n        beforeGenerationHook = hooks.beforeAssetTagGeneration\n      }\n\n      beforeGenerationHook.tapAsync(\n        'HtmlWebpackChangeAssetsExtensionPlugin',\n        (data: any, cb: Function) => {\n          // Skip if the plugin configuration didn't set `jsExtension`\n          if (!data.plugin.options.jsExtension) {\n            return cb(null, data)\n          }\n          const jsExtension = data.plugin.options.jsExtension\n          const tempArray = data.assets.js\n          data.assets.js = tempArray.map((scriptFile: any) => {\n            if(data.plugin.options.extdebug) {\n              console.log('ext',scriptFile)\n            }\n            const s = scriptFile as string;\n            if(s) {\n              if (data.plugin.options.extlocalonly) {\n                if(data.plugin.options.extdebug) console.log('extlocalonly',s);\n                if (s.includes('http')) {\n                  if(data.plugin.options.extdebug) console.log('extlocalonly return',s);\n                  return scriptFile;\n                }\n              }\n              let ret = `${scriptFile}${jsExtension}`;\n              if(s.includes('?')) {\n                const fileSplit = s.split('?');\n                ret = `${fileSplit[0]}${jsExtension}?${fileSplit[1]}`;\n              }\n              return ret;\n            }\n\n            return `${scriptFile}${jsExtension}`\n          })\n          return cb(null, data)\n        }\n      )\n    })\n  }\n}\n"],"names":[],"mappings":"AAAA,IAAM,iBAAiB,GAAG,OAAO,CAAC,qBAAqB,CAAC,CAAA;AAExD;IAGE,gDAAY,OAAgB;QAC1B,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,EAAE,CAAA;KAC7B;IAED,sDAAK,GAAL,UAAM,QAAa;QACjB,QAAQ,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,wCAAwC,EAAE,UAAC,WAAgB;YACxF,IAAI,oBAAoB,CAAA;YACxB,IAAI,WAAW,CAAC,KAAK,CAAC,qCAAqC,EAAE;;gBAEnD,IAAA,KAAK,GAAK,WAAW,MAAhB,CAAgB;gBAC7B,oBAAoB,GAAG,KAAK,CAAC,qCAAqC,CAAA;aACnE;iBAAM,IAAI,iBAAiB,CAAC,OAAO,KAAK,CAAC,EAAE;;gBAE1C,IAAM,KAAK,GAAG,iBAAiB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAA;gBACrD,oBAAoB,GAAG,KAAK,CAAC,wBAAwB,CAAA;aACtD;YAED,oBAAoB,CAAC,QAAQ,CAC3B,wCAAwC,EACxC,UAAC,IAAS,EAAE,EAAY;;gBAEtB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,EAAE;oBACpC,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;iBACtB;gBACD,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,CAAA;gBACnD,IAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAA;gBAChC,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,SAAS,CAAC,GAAG,CAAC,UAAC,UAAe;oBAC7C,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE;wBAC/B,OAAO,CAAC,GAAG,CAAC,KAAK,EAAC,UAAU,CAAC,CAAA;qBAC9B;oBACD,IAAM,CAAC,GAAG,UAAoB,CAAC;oBAC/B,IAAG,CAAC,EAAE;wBACJ,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,YAAY,EAAE;4BACpC,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;gCAAE,OAAO,CAAC,GAAG,CAAC,cAAc,EAAC,CAAC,CAAC,CAAC;4BAC/D,IAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;gCACtB,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;oCAAE,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAC,CAAC,CAAC,CAAC;gCACtE,OAAO,UAAU,CAAC;6BACnB;yBACF;wBACD,IAAI,GAAG,GAAG,KAAG,UAAU,GAAG,WAAa,CAAC;wBACxC,IAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;4BAClB,IAAM,SAAS,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;4BAC/B,GAAG,GAAG,KAAG,SAAS,CAAC,CAAC,CAAC,GAAG,WAAW,SAAI,SAAS,CAAC,CAAC,CAAG,CAAC;yBACvD;wBACD,OAAO,GAAG,CAAC;qBACZ;oBAED,OAAO,KAAG,UAAU,GAAG,WAAa,CAAA;iBACrC,CAAC,CAAA;gBACF,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;aACtB,CACF,CAAA;SACF,CAAC,CAAA;KACH;IACH,6CAAC;AAAD,CAAC;;;;"}